#include <Servo.h>

Servo headRotate;
Servo headUp;

Servo rindex, rmajeur, rpinky, rring, rbicep, rrotate, rshoulder, rclavi;



String currentMessage = ""; // variable to store the current message


int rotatePos = 90;    // variable to store the servo position
int upPos = 100;    // variable to store the servo position


void setup() {

  headRotate.attach(2); 
  headUp.attach(3);
  rmajeur.attach(4);
  rpinky.attach(6);
  rring.attach(7);
  rbicep.attach(8);
  rrotate.attach(9);
  rshoulder.attach(10);
  rclavi.attach(11);

  delay(2000);
  // open the serial port:
  Serial.begin(115200);

  //this pin is the one to turn on/off the magnet. It setup as digital output
  //pinMode(rMagnetPin, OUTPUT);

  //all the servos to rest position or p0
  headRotate.write(rotatePos);
  headUp.write(upPos);
  rrotate.write(80);
  rshoulder.write(60);
  rbicep.write(110);
  rclavi.write(105);

  // open the serial port:
  Serial.begin(115200);


  delay(1000);

}

void loop() {


// read serial msg send from the pyhton code.
  if (Serial.available() > 0) {
    String message = Serial.readStringUntil('\n');

    if (message != currentMessage) {
      currentMessage = message;
    }


    if (currentMessage == "R" && currentMessage != "C" && rotatePos > 10){
        rotatePos--;
      }

    else if (currentMessage == "L" && currentMessage != "C" && rotatePos < 170){
        rotatePos++;
      }

    else if ((currentMessage == "X" || currentMessage == "E") && currentMessage != "C" && rotatePos != 90 ){
        if (rotatePos < 90){
          for(int i = rotatePos; i <= 90; i++){
            rotatePos = i;
            headRotate.write(rotatePos);
            delay(50);
          }
        }
        else if(rotatePos > 90){
          for(int i = rotatePos; i >= 90; i--){
            rotatePos = i;
            headRotate.write(rotatePos);
            delay(50);
          }
        }
        delay(4000);
      }

    headRotate.write(rotatePos);              // tell servo to go to position in variable 'pos'

    
    }


}
